<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Viewer</title>
  <style>html,body{height:100%;margin:0;background:#111;overflow:hidden}canvas{display:block;width:100%;height:100%}</style>
</head>
<body>
<script type="module">
  import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.165.0/build/three.module.js';
  import { GLTFLoader }   from 'https://cdn.jsdelivr.net/npm/three@0.165.0/examples/jsm/loaders/GLTFLoader.js';
  import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.165.0/examples/jsm/controls/OrbitControls.js';

  const scene = new THREE.Scene(); scene.background = new THREE.Color(0x222222);
  const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.01, 2000);
  const renderer = new THREE.WebGLRenderer({antialias:true}); renderer.setSize(innerWidth, innerHeight);
  document.body.appendChild(renderer.domElement);

  scene.add(new THREE.AmbientLight(0xffffff, 0.6));
  const d = new THREE.DirectionalLight(0xffffff, 1.1); d.position.set(3,5,2); scene.add(d);

  const controls = new OrbitControls(camera, renderer.domElement);
  controls.enableDamping = true; controls.autoRotate = true; camera.position.set(0,1,3);

  new GLTFLoader().load('./PScolor_3D.glb', (gltf)=>{
    scene.add(gltf.scene); fit(camera, gltf.scene, controls);
  });

  function fit(cam,obj,ctrl){ const b=new THREE.Box3().setFromObject(obj), c=b.getCenter(new THREE.Vector3()),
    s=b.getSize(new THREE.Vector3()), m=Math.max(s.x,s.y,s.z)||1, dist=m/(2*Math.tan(THREE.MathUtils.degToRad(cam.fov)/2));
    cam.near=dist/100; cam.far=dist*100; cam.updateProjectionMatrix(); cam.position.copy(c).add(new THREE.Vector3(dist,dist*0.3,dist));
    ctrl.target.copy(c); ctrl.update(); }

  (function loop(){ requestAnimationFrame(loop); controls.update(); renderer.render(scene,camera); })();
  addEventListener('resize',()=>{ camera.aspect=innerWidth/innerHeight; camera.updateProjectionMatrix(); renderer.setSize(innerWidth,innerHeight); });
</script>
</body>
</html>
